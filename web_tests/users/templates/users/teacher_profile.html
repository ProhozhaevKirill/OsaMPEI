{% extends 'create_tests/header.html' %}
{% load static %}

{% block extra_css %}
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}">
    <link rel="stylesheet" href='{% static "css/student_data.css" %}'>
{% endblock %}

{% block extra_js %}

{% endblock %}

{% block content %}
<div class="profile-container">
    <h1 class="profile-title">Профиль преподавателя</h1>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}" style="padding: 10px; margin: 10px 0; border-radius: 4px; background: {% if message.tags == 'success' %}#d4edda; color: #155724;{% else %}#f8d7da; color: #721c24;{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <form method="POST" enctype="multipart/form-data" class="profile-form">
        {% csrf_token %}

        <div class="form-section">
            <h2>Основные данные</h2>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" value="{{ user.email }}" required>
            </div>
        </div>

        <div class="form-section">
            <h2>Личные данные</h2>
            <div class="form-row">
                <div class="form-group">
                    <label>Фото профиля</label>
                    {% if data.photo %}
                        <div class="current-photo">
                            <img src="{{ data.photo.url }}" alt="Текущее фото" style="max-width: 150px; max-height: 150px; border-radius: 50%; object-fit: cover;">
                            <p>Текущее фото</p>
                            <button type="submit" name="delete_photo" class="delete-photo-btn" onclick="return confirm('Вы уверены, что хотите удалить фото?')" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px;">
                                <i class="fas fa-trash"></i> Удалить фото
                            </button>
                        </div>
                    {% endif %}
                    <input type="file" name="photo" accept="image/*">
                    <small>Загрузите новое фото (необязательно)</small>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Фамилия</label>
                    <input type="text" name="last_name" value="{{ data.last_name }}" required>
                </div>
                <div class="form-group">
                    <label>Имя</label>
                    <input type="text" name="first_name" value="{{ data.first_name }}" required>
                </div>
                <div class="form-group">
                    <label>Отчество</label>
                    <input type="text" name="middle_name" value="{{ data.middle_name }}">
                </div>
            </div>
        </div>

        <div class="form-section">
            <h2>Учебные данные</h2>
            <div class="form-row">
                <div class="form-group">
                    <label>Институт</label>
                    <select name="institute" required>
                        {% for institute in institutes %}
                        <option value="{{ institute.id }}"
                                {% if data.institute.id == institute.id %}selected{% endif %}>
                            {{ institute.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <button type="submit" class="save-btn">Сохранить изменения</button>
    </form>
</div>
{% endblock %}